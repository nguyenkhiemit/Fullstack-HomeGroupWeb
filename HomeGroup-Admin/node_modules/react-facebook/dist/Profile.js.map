{"version":3,"sources":["../src/Profile.jsx"],"names":["Profile","Component","state","loading","handleReady","api","updateProfile","handleStatusChange","props","fields","response","getLoginStatus","status","LoginStatus","CONNECTED","setState","profile","undefined","error","getProfile","render","children","defaultProps","Fields"],"mappings":";;;;;;;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAae,MAAMA,OAAN,SAAsBC,gBAAtB,CAA8C;AAAA;AAAA;;AAAA,gDAK3DC,KAL2D,GAK5C;AACbC,eAAS;AADI,KAL4C,OAS3DC,WAT2D;AAAA,iDAS7C,WAAOC,GAAP,EAAsC;AAClD,cAAKA,GAAL,GAAWA,GAAX;;AAEA,cAAKC,aAAL;AACD,OAb0D;;AAAA;AAAA;AAAA;AAAA,eAe3DC,kBAf2D,GAetC,MAAY;AAC/B,WAAKD,aAAL;AACD,KAjB0D;AAAA;;AAmBrDA,eAAN,GAAsB;AAAA;;AAAA;AACpB,YAAM,EAAED,GAAF,EAAOG,OAAO,EAAEC,MAAF,EAAd,KAA6B,MAAnC;AACA,UAAI,CAACJ,GAAL,EAAU;AACR;AACD;;AAED,UAAI;AACF,cAAMK,WAAW,MAAML,IAAIM,cAAJ,EAAvB;AACA,YAAID,SAASE,MAAT,KAAoBC,sBAAYC,SAApC,EAA+C;AAC7C,iBAAKC,QAAL,CAAc;AACZC,qBAASC,SADG;AAEZd,qBAAS,KAFG;AAGZe,mBAAOD;AAHK,WAAd;;AAMA;AACD;;AAED,cAAMD,UAAU,MAAMX,IAAIc,UAAJ,CAAe;AACnCV;AADmC,SAAf,CAAtB;;AAIA,eAAKM,QAAL,CAAc;AACZC,iBADY;AAEZb,mBAAS,KAFG;AAGZe,iBAAOD;AAHK,SAAd;AAKD,OArBD,CAqBE,OAAOC,KAAP,EAAc;AACd,eAAKH,QAAL,CAAc;AACZC,mBAASC,SADG;AAEZd,mBAAS,KAFG;AAGZe;AAHY,SAAd;AAKD;AAjCmB;AAkCrB;;AAEDE,WAAS;AACP,UAAM,EAAEC,QAAF,KAAe,KAAKb,KAA1B;AACA,UAAM,EAAEQ,OAAF,EAAWb,OAAX,EAAoBe,KAApB,KAA8B,KAAKhB,KAAzC;;AAEA,WACE;AAAC,0BAAD;AAAA,QAAY,SAAS,KAAKE,WAA1B;AACE;AAAC,2BAAD;AAAA,UAAW,OAAM,mBAAjB,EAAqC,UAAU,KAAKG,kBAApD;AACGc,iBAAS;AACRL,iBADQ;AAERb,iBAFQ;AAGRe;AAHQ,SAAT;AADH;AADF,KADF;AAWD;AAtE0D;kBAAxClB,O;AAAAA,O,CACZsB,Y,GAAe;AACpBb,UAAQc;AADY,C","file":"Profile.js","sourcesContent":["// @flow\nimport React, { Component } from 'react';\nimport Initialize from './Initialize';\nimport Subscribe from './Subscribe';\nimport Fields from './constants/Fields';\nimport LoginStatus from './constants/LoginStatus';\n\ntype Props = {\n  children: Function,\n  fields?: string[],\n};\n\ntype State = {\n  loading: Boolean,\n  profile?: Object,\n  error?: Error,\n};\n\nexport default class Profile extends Component<Props, State> {\n  static defaultProps = {\n    fields: Fields,\n  };\n\n  state: State = {\n    loading: true,\n  };\n\n  handleReady = async (api: Object): Promise<void> => {\n    this.api = api;\n\n    this.updateProfile();\n  }\n\n  handleStatusChange = (): void => {\n    this.updateProfile();\n  }\n\n  async updateProfile() {\n    const { api, props: { fields } } = this;\n    if (!api) {\n      return;\n    }\n\n    try {\n      const response = await api.getLoginStatus();\n      if (response.status !== LoginStatus.CONNECTED) {\n        this.setState({\n          profile: undefined,\n          loading: false,\n          error: undefined,\n        });\n\n        return;\n      }\n\n      const profile = await api.getProfile({\n        fields,\n      });\n\n      this.setState({\n        profile,\n        loading: false,\n        error: undefined,\n      });\n    } catch (error) {\n      this.setState({\n        profile: undefined,\n        loading: false,\n        error,\n      });\n    }\n  }\n\n  render() {\n    const { children } = this.props;\n    const { profile, loading, error } = this.state;\n\n    return (\n      <Initialize onReady={this.handleReady}>\n        <Subscribe event=\"auth.statusChange\" onChange={this.handleStatusChange}>\n          {children({\n            profile,\n            loading,\n            error,\n          })}\n        </Subscribe>\n      </Initialize>\n    );\n  }\n}\n"]}