{"version":3,"sources":["../src/Profile.jsx"],"names":["React","Component","Initialize","Subscribe","Fields","LoginStatus","Profile","state","loading","handleReady","api","updateProfile","handleStatusChange","props","fields","response","getLoginStatus","status","CONNECTED","setState","profile","undefined","error","getProfile","render","children","defaultProps"],"mappings":";AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,MAAP,MAAmB,oBAAnB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;;AAaA,eAAe,MAAMC,OAAN,SAAsBL,SAAtB,CAA8C;AAAA;AAAA;;AAAA,gDAK3DM,KAL2D,GAK5C;AACbC,eAAS;AADI,KAL4C,OAS3DC,WAT2D;AAAA,mCAS7C,WAAOC,GAAP,EAAsC;AAClD,cAAKA,GAAL,GAAWA,GAAX;;AAEA,cAAKC,aAAL;AACD,OAb0D;;AAAA;AAAA;AAAA;AAAA,eAe3DC,kBAf2D,GAetC,MAAY;AAC/B,WAAKD,aAAL;AACD,KAjB0D;AAAA;;AAmBrDA,eAAN,GAAsB;AAAA;;AAAA;AACpB,YAAM,EAAED,GAAF,EAAOG,OAAO,EAAEC,MAAF,EAAd,KAA6B,MAAnC;AACA,UAAI,CAACJ,GAAL,EAAU;AACR;AACD;;AAED,UAAI;AACF,cAAMK,WAAW,MAAML,IAAIM,cAAJ,EAAvB;AACA,YAAID,SAASE,MAAT,KAAoBZ,YAAYa,SAApC,EAA+C;AAC7C,iBAAKC,QAAL,CAAc;AACZC,qBAASC,SADG;AAEZb,qBAAS,KAFG;AAGZc,mBAAOD;AAHK,WAAd;;AAMA;AACD;;AAED,cAAMD,UAAU,MAAMV,IAAIa,UAAJ,CAAe;AACnCT;AADmC,SAAf,CAAtB;;AAIA,eAAKK,QAAL,CAAc;AACZC,iBADY;AAEZZ,mBAAS,KAFG;AAGZc,iBAAOD;AAHK,SAAd;AAKD,OArBD,CAqBE,OAAOC,KAAP,EAAc;AACd,eAAKH,QAAL,CAAc;AACZC,mBAASC,SADG;AAEZb,mBAAS,KAFG;AAGZc;AAHY,SAAd;AAKD;AAjCmB;AAkCrB;;AAEDE,WAAS;AACP,UAAM,EAAEC,QAAF,KAAe,KAAKZ,KAA1B;AACA,UAAM,EAAEO,OAAF,EAAWZ,OAAX,EAAoBc,KAApB,KAA8B,KAAKf,KAAzC;;AAEA,WACE;AAAC,gBAAD;AAAA,QAAY,SAAS,KAAKE,WAA1B;AACE;AAAC,iBAAD;AAAA,UAAW,OAAM,mBAAjB,EAAqC,UAAU,KAAKG,kBAApD;AACGa,iBAAS;AACRL,iBADQ;AAERZ,iBAFQ;AAGRc;AAHQ,SAAT;AADH;AADF,KADF;AAWD;AAtE0D;AAAxChB,O,CACZoB,Y,GAAe;AACpBZ,UAAQV;AADY,C","file":"Profile.js","sourcesContent":["// @flow\nimport React, { Component } from 'react';\nimport Initialize from './Initialize';\nimport Subscribe from './Subscribe';\nimport Fields from './constants/Fields';\nimport LoginStatus from './constants/LoginStatus';\n\ntype Props = {\n  children: Function,\n  fields?: string[],\n};\n\ntype State = {\n  loading: Boolean,\n  profile?: Object,\n  error?: Error,\n};\n\nexport default class Profile extends Component<Props, State> {\n  static defaultProps = {\n    fields: Fields,\n  };\n\n  state: State = {\n    loading: true,\n  };\n\n  handleReady = async (api: Object): Promise<void> => {\n    this.api = api;\n\n    this.updateProfile();\n  }\n\n  handleStatusChange = (): void => {\n    this.updateProfile();\n  }\n\n  async updateProfile() {\n    const { api, props: { fields } } = this;\n    if (!api) {\n      return;\n    }\n\n    try {\n      const response = await api.getLoginStatus();\n      if (response.status !== LoginStatus.CONNECTED) {\n        this.setState({\n          profile: undefined,\n          loading: false,\n          error: undefined,\n        });\n\n        return;\n      }\n\n      const profile = await api.getProfile({\n        fields,\n      });\n\n      this.setState({\n        profile,\n        loading: false,\n        error: undefined,\n      });\n    } catch (error) {\n      this.setState({\n        profile: undefined,\n        loading: false,\n        error,\n      });\n    }\n  }\n\n  render() {\n    const { children } = this.props;\n    const { profile, loading, error } = this.state;\n\n    return (\n      <Initialize onReady={this.handleReady}>\n        <Subscribe event=\"auth.statusChange\" onChange={this.handleStatusChange}>\n          {children({\n            profile,\n            loading,\n            error,\n          })}\n        </Subscribe>\n      </Initialize>\n    );\n  }\n}\n"]}