{"version":3,"sources":["../src/Login.jsx"],"names":["Login","Component","handleClick","evn","preventDefault","handleProcess","onCompleted","onError","props","api","scope","fields","returnScopes","rerequest","reauthorize","eventKey","loginQpts","authType","return_scopes","push","length","auth_type","join","response","login","status","Error","data","getTokenDetailWithProfile","error","render","children","loading","defaultProps","Fields","undefined","ref"],"mappings":";;;;;;;;;;;;;;AACA;;;;AACA;;;;AACA;;;;;;AAkBA,MAAMA,KAAN,SAAoBC,gBAApB,CAAqC;AAAA;AAAA;;AAAA,gDAYnCC,WAZmC;AAAA,iDAYrB,WAAOC,GAAP,EAAe;AAC3BA,YAAIC,cAAJ;;AAEA,cAAM,EAAEC,aAAF,EAAiBC,WAAjB,EAA8BC,OAA9B,KAA0C,MAAKC,KAArD;;AAEA,YAAI;AACF,gBAAMH;AAAA,wDAAc,WAAOI,GAAP,EAAe;AACjC,oBAAM;AACJC,qBADI,EACGC,MADH,EACWC,YADX,EACyBC,SADzB,EACoCC,WADpC,EACiDC;AADjD,kBAEF,MAAKP,KAFT;AAGA,oBAAMQ,YAAY,EAAEN,KAAF,EAAlB;AACA,oBAAMO,WAAW,EAAjB;;AAEA,kBAAIL,YAAJ,EAAkB;AAChBI,0BAAUE,aAAV,GAA0B,IAA1B;AACD;;AAED,kBAAIL,SAAJ,EAAe;AACbI,yBAASE,IAAT,CAAc,WAAd;AACD;;AAED,kBAAIL,WAAJ,EAAiB;AACfG,yBAASE,IAAT,CAAc,gBAAd;AACD;;AAED,kBAAIF,SAASG,MAAb,EAAqB;AACnBJ,0BAAUK,SAAV,GAAsBJ,SAASK,IAAT,CAAc,GAAd,CAAtB;AACD;;AAED,oBAAMC,WAAW,MAAMd,IAAIe,KAAJ,CAAUR,SAAV,CAAvB;AACA,kBAAIO,SAASE,MAAT,KAAoB,WAAxB,EAAqC;AACnC,sBAAM,IAAIC,KAAJ,CAAU,mBAAV,CAAN;AACD;;AAED,oBAAMC,OAAO,MAAMlB,IAAImB,yBAAJ,CAA8B,EAAEjB,MAAF,EAA9B,CAAnB;;AAEA,kBAAIL,WAAJ,EAAiB;AACf,sBAAMA,uCACDqB,IADC;AAEJZ;AAFI,mBAAN;AAID;;AAED,qBAAOY,IAAP;AACD,aAtCK;;AAAA;AAAA;AAAA;AAAA,eAAN;AAuCD,SAxCD,CAwCE,OAAOE,KAAP,EAAc;AACd,cAAItB,OAAJ,EAAa;AACXA,oBAAQsB,KAAR;AACD;AACF;AACF,OA9DkC;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAgEnCC,WAAS;AACP,UAAM;AACJC,cADI,EACMC,OADN,EACeH,KADf,EACsBF;AADtB,QAEF,KAAKnB,KAFT;;AAIA,WAAOuB,SAAS;AACdC,aADc;AAEd9B,mBAAa,KAAKA,WAFJ;AAGd2B,WAHc;AAIdF;AAJc,KAAT,CAAP;AAMD;AA3EkC;AAA/B3B,K,CACGiC,Y,GAAe;AACpBvB,SAAO,EADa;AAEpBC,UAAQuB,gBAFY;AAGpBtB,gBAAc,KAHM;AAIpBC,aAAW,KAJS;AAKpBC,eAAa,KALO;AAMpBR,eAAa6B,SANO;AAOpB5B,WAAS4B,SAPW;AAQpBpB,YAAUoB;AARU,C;kBA6ET,uBAAW,CAAC3B,KAAD,EAAQ4B,GAAR,KACxB;AAAC,mBAAD;AAAA;AACG,GAAC;AACAJ,WADA,EACS3B,aADT,EACwBsB,IADxB,EAC8BE;AAD9B,GAAD,KAGC,8BAAC,KAAD,6BACMrB,KADN;AAEE,aAASwB,OAFX;AAGE,mBAAe3B,aAHjB;AAIE,UAAMsB,IAJR;AAKE,WAAOE,KALT;AAME,SAAKO;AANP;AAJJ,CADa,C","file":"Login.js","sourcesContent":["// @flow\nimport React, { Component, forwardRef } from 'react';\nimport Process from './Process';\nimport Fields from './constants/Fields';\n\ntype Props = {\n  children: Function,\n  handleProcess: Function,\n  loading: boolean,\n  data: any,\n  error: Error,\n  scope?: string,\n  fields?: string[],\n  returnScopes?: boolean,\n  rerequest?: boolean,\n  reauthorize?: boolean,\n  onCompleted?: Function,\n  onError?: Function,\n  eventKey?: any,\n};\n\nclass Login extends Component<Props> {\n  static defaultProps = {\n    scope: '',\n    fields: Fields,\n    returnScopes: false,\n    rerequest: false,\n    reauthorize: false,\n    onCompleted: undefined,\n    onError: undefined,\n    eventKey: undefined,\n  };\n\n  handleClick = async (evn) => {\n    evn.preventDefault();\n\n    const { handleProcess, onCompleted, onError } = this.props;\n\n    try {\n      await handleProcess(async (api) => {\n        const {\n          scope, fields, returnScopes, rerequest, reauthorize, eventKey,\n        } = this.props;\n        const loginQpts = { scope };\n        const authType = [];\n\n        if (returnScopes) {\n          loginQpts.return_scopes = true;\n        }\n\n        if (rerequest) {\n          authType.push('rerequest');\n        }\n\n        if (reauthorize) {\n          authType.push('reauthenticate');\n        }\n\n        if (authType.length) {\n          loginQpts.auth_type = authType.join(',');\n        }\n\n        const response = await api.login(loginQpts);\n        if (response.status !== 'connected') {\n          throw new Error('Unauthorized user');\n        }\n\n        const data = await api.getTokenDetailWithProfile({ fields });\n\n        if (onCompleted) {\n          await onCompleted({\n            ...data,\n            eventKey,\n          });\n        }\n\n        return data;\n      });\n    } catch (error) {\n      if (onError) {\n        onError(error);\n      }\n    }\n  }\n\n  render() {\n    const {\n      children, loading, error, data,\n    } = this.props;\n\n    return children({\n      loading,\n      handleClick: this.handleClick,\n      error,\n      data,\n    });\n  }\n}\n\nexport default forwardRef((props, ref) => (\n  <Process>\n    {({\n      loading, handleProcess, data, error,\n    }) => (\n      <Login\n        {...props}\n        loading={loading}\n        handleProcess={handleProcess}\n        data={data}\n        error={error}\n        ref={ref}\n      />\n    )}\n  </Process>\n));\n"]}